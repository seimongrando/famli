# ==============================================================================
# Famli - Configuração do Render (Infrastructure as Code)
# ==============================================================================
# Este arquivo permite configurar o deploy automaticamente no Render.
#
# Para usar:
#   1. Vá em https://dashboard.render.com/
#   2. Clique em "New" > "Blueprint"
#   3. Conecte seu repositório
#   4. O Render detectará este arquivo automaticamente
#
# Documentação: https://render.com/docs/blueprint-spec
# ==============================================================================

services:
  # ============================================================================
  # FAMLI - Web Service
  # ============================================================================
  - type: web
    name: famli
    runtime: go
    
    # Plano (free, starter, standard, pro)
    plan: free
    
    # Região (oregon, frankfurt, ohio, singapore)
    region: oregon
    
    # Branch para deploy
    branch: main
    
    # Comandos de build e start
    buildCommand: ./scripts/render-build.sh
    startCommand: ./scripts/render-start.sh
    
    # Health check
    healthCheckPath: /
    
    # Variáveis de ambiente
    envVars:
      # Ambiente
      - key: ENV
        value: production
      
      # Porta (gerenciada pelo Render)
      - key: PORT
        fromService:
          type: web
          name: famli
          property: port
      
      # Segredos (gerar valores aleatórios)
      - key: JWT_SECRET
        generateValue: true
      
      - key: ENCRYPTION_KEY
        generateValue: true
      
      # Diretório do frontend
      - key: STATIC_DIR
        value: ../frontend/dist
      
      # WhatsApp/Twilio (configurar manualmente se necessário)
      # - key: TWILIO_ACCOUNT_SID
      #   sync: false
      # - key: TWILIO_AUTH_TOKEN
      #   sync: false
      # - key: TWILIO_PHONE_NUMBER
      #   sync: false
      # - key: WEBHOOK_BASE_URL
      #   fromService:
      #     type: web
      #     name: famli
      #     property: host

